description: Huntsman flat calibration construction.
tasks:
  isr:
    class: lsst.ip.isr.IsrTask
    config:
      connections.ccdExposure: "raw"
      connections.outputExposure: "cpFlatProc"
      doBias: True
      doVariance: True
      doLinearize: False
      doCrosstalk: False
      doDefect: False
      doNanMasking: True
      doInterpolate: True
      doDark: True
      doBrighterFatter: False
      doFlat: False
      doFringe: False
      doApplyGains: False
      doOverscan: False
      doSaturationInterpolation: True
      # Vignette seems to be necessary to get the validPolygon
      doVignette: False
      vignette.doWriteVignettePolygon: False
  cpFlatMeasure:
    class: lsst.cp.pipe.cpFlatNormTask.CpFlatMeasureTask
    config:
      doVignette: False
      connections.inputExp: "cpFlatProc"
      connections.outputStats: "flatStats"
  cpFlatNorm:
    class: lsst.cp.pipe.cpFlatNormTask.CpFlatNormalizationTask
    config:
      connections.inputMDs: "flatStats"
      connections.outputScales: "cpFlatNormScales"
  cpFlatCombine:
    class: lsst.cp.pipe.cpCombine.CalibCombineByFilterTask
    config:
      connections.inputExps: "cpFlatProc"
      connections.inputScales: "cpFlatNormScales"
      connections.outputData: "flat"
      calibrationType: "flat"
      exposureScaling: InputList
      scalingLevel: AMP
contracts:
  - isr.doFlat == False
